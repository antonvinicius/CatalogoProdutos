@page "/produtos"

<CrudElement Items="produtos" EntityName="Produtos" CreateCallBack="() => createModal.Show()">
    @foreach (var item in produtos)
    {
        <ProductPanel Produto="item"></ProductPanel>
    }
</CrudElement>

<MessageModal @ref="createModal" CorBotaoSubmit="Color.Primary" Icone="@Icons.Filled.Create" Submit="CreateItem" TextoCancelar="Cancelar" TextoSubmit="Criar" Title="Cadastrar novo produto">
    <EditForm Model="produto">
        <MudTextField Label="Nome" @bind-Value="produto.Nome" For="() => produto.Nome" Class="ma-3"></MudTextField>
        <MudTextField Label="Preço" @bind-Value="produto.Preco" For="() => produto.Preco" Class="ma-3"></MudTextField>
    </EditForm>
</MessageModal>


@code {
    Produto produto = new Produto();

    List<Produto> produtos;

    protected override void OnInitialized()
    {
        produtos = new List<Produto>()
    {
            new Produto()
            {
                Id = 1,
                Nome = "Smartphone Galaxy S3",
                CategoriaId = 1,
                Preco = 30.99
            },
            new Produto()
            {
                Id = 2,
                Nome = "Iphone 10",
                Preco = 83.45
            },
        new Produto()
            {
                Id = 3,
                Nome = "Notebook i5 9300 GTX 1050 Ti",
                Preco = 83.45
            }
        };
    }

    MessageModal createModal;

    void CreateItem(bool? result)
    {
        if (result != null)
        {
            produtos.Add(produto);
            produto = new Produto();
        }
    }
}
